# üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º (Troubleshooting)

–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–µ—à–µ–Ω–∏—é —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Telegram Chat Analyzer.

---

## üö´ –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

### –û—à–∏–±–∫–∞: `ModuleNotFoundError: No module named 'telethon'`

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
pip install -r requirements.txt
# –∏–ª–∏
pip3 install -r requirements.txt
```

---

### –û—à–∏–±–∫–∞: `ValueError: invalid literal for int() with base 10`

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω —Ñ–∞–π–ª `private.txt`.

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ `private.txt`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `TELEGRAM_API_ID` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã (–±–µ–∑ –∫–∞–≤—ã—á–µ–∫)
3. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:
```
TELEGRAM_API_ID=12345678
TELEGRAM_API_HASH=abcdef1234567890abcdef1234567890
```

–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
```
TELEGRAM_API_ID="12345678"  # –£–±—Ä–∞—Ç—å –∫–∞–≤—ã—á–∫–∏
TELEGRAM_API_ID=–≤–∞—à_api_id  # –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —Ü–∏—Ñ—Ä—ã
```

---

### –û—à–∏–±–∫–∞: `FileNotFoundError: [Errno 2] No such file or directory: 'private.txt'`

**–ü—Ä–∏—á–∏–Ω–∞:** –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `private.txt` –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ –ø–æ –ø—Ä–∏–º–µ—Ä—É –∏–∑ README
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –±–æ—Ç–∞ –∏–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
```bash
cd /path/to/chat-filter
python main.py
```

---

## üîê –ü—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

### –ë–æ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∫–æ–¥, –Ω–æ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –µ–≥–æ

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å Telegram API.

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ `private.txt` —É–∫–∞–∑–∞–Ω –≤ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:
```
TELEGRAM_PHONE=+79991234567
```

2. –£–¥–∞–ª–∏—Ç–µ —Ñ–∞–π–ª —Å–µ—Å—Å–∏–∏ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞:
```bash
rm session_name.session
python main.py
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –≤ Telegram

---

### –û—à–∏–±–∫–∞: `SessionPasswordNeededError`

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–∞ –≤–∞—à–µ–º –∞–∫–∫–∞—É–Ω—Ç–µ –≤–∫–ª—é—á–µ–Ω–∞ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA).

**–†–µ—à–µ–Ω–∏–µ:**

–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –±–æ—Ç–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 2FA –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ 2FA –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤ –∫–æ–¥:

```python
# –í main.py, –≤ —Ñ—É–Ω–∫—Ü–∏–∏ main():
await telegram_client.start(
    phone=PHONE,
    password=lambda: input('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å 2FA: ')
)
```

–ò–ª–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –≤ `private.txt`:
```
TELEGRAM_2FA_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å_2fa
```

–ò –≤ –∫–æ–¥–µ:
```python
TWO_FA_PASSWORD = os.getenv('TELEGRAM_2FA_PASSWORD')

await telegram_client.start(
    phone=PHONE,
    password=TWO_FA_PASSWORD
)
```

---

### –û—à–∏–±–∫–∞: `PhoneNumberBannedError`

**–ü—Ä–∏—á–∏–Ω–∞:** –í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –≤ Telegram.

**–†–µ—à–µ–Ω–∏–µ:**
1. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É Telegram: @SpamBot
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π –∞–∫–∫–∞—É–Ω—Ç Telegram
3. –ü–æ–¥–æ–∂–¥–∏—Ç–µ, –ø–æ–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ –±—É–¥–µ—Ç —Å–Ω—è—Ç–∞

---

## ü§ñ –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ –±–æ—Ç–∞

### –ë–æ—Ç –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã

**–ü—Ä–∏—á–∏–Ω–∞ 1:** –ö–æ–º–∞–Ω–¥—ã –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è –∫–∞–∫ –∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ –∫–æ–º–∞–Ω–¥—ã **–æ—Ç —Å–≤–æ–µ–≥–æ –∏–º–µ–Ω–∏**
- –ö–æ–º–∞–Ω–¥—ã –¥–æ–ª–∂–Ω—ã –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `/` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/analyze`)
- –ë–æ—Ç —Ä–µ–∞–≥–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ **–≤–∞—à–∏** —Å–æ–æ–±—â–µ–Ω–∏—è (outgoing), –∞ –Ω–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ü—Ä–∏—á–∏–Ω–∞ 2:** –ë–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ "üëÄ –û–∂–∏–¥–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥...")
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –∑–∞–Ω–æ–≤–æ:
```bash
python main.py
```

---

### –ö–æ–º–∞–Ω–¥–∞ `/analyze` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—á–µ–Ω—å –¥–æ–ª–≥–æ

**–ü—Ä–∏—á–∏–Ω–∞:** –í —á–∞—Ç–µ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥.

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–º–µ–Ω—å—à–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞:
```
/analyze 6h   # –í–º–µ—Å—Ç–æ /analyze 1d
```

2. –£–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∫–æ–¥–µ (—Ñ–∞–π–ª `main.py`, —Ñ—É–Ω–∫—Ü–∏—è `create_summary`):
```python
max_chars = 25000  # –£–≤–µ–ª–∏—á–∏—Ç—å —Å 15000
```

3. –ü–æ–¥–æ–∂–¥–∏—Ç–µ - –∞–Ω–∞–ª–∏–∑ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏

---

### –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: Message too long

**–ü—Ä–∏—á–∏–Ω–∞:** –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç Telegram (4096 —Å–∏–º–≤–æ–ª–æ–≤).

**–†–µ—à–µ–Ω–∏–µ:**

–ö–æ–¥ —É–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–∏–≤–∞–µ—Ç –¥–ª–∏–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –≤—Å—ë —Ä–∞–≤–Ω–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç:

1. –£–º–µ–Ω—å—à–∏—Ç–µ `max_tokens` –≤ –∑–∞–ø—Ä–æ—Å–µ –∫ Perplexity:
```python
# –í —Ñ—É–Ω–∫—Ü–∏–∏ create_summary:
max_tokens=1000  # –í–º–µ—Å—Ç–æ 2000
```

2. –ü–æ–ø—Ä–æ—Å–∏—Ç–µ Perplexity –±—ã—Ç—å –±–æ–ª–µ–µ –∫—Ä–∞—Ç–∫–∏–º –≤ –ø—Ä–æ–º—Ç–µ:
```python
ANALYSIS_PROMPT = """... 
–ë—É–¥—å –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û –∫—Ä–∞—Ç–∫–∏–º –∏ –ª–∞–∫–æ–Ω–∏—á–Ω—ã–º.
"""
```

---

## üåê –ü—Ä–æ–±–ª–µ–º—ã —Å Perplexity API

### –û—à–∏–±–∫–∞: `AuthenticationError` –∏–ª–∏ `401 Unauthorized`

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π API –∫–ª—é—á Perplexity.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á –Ω–∞ https://www.perplexity.ai/settings/api
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤)
3. –û–±–Ω–æ–≤–∏—Ç–µ `private.txt`:
```
PERPLEXITY_API_KEY=–≤–∞—à_–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π_–∫–ª—é—á
```

4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

---

### –û—à–∏–±–∫–∞: `InsufficientCreditsError` –∏–ª–∏ `429 Too Many Requests`

**–ü—Ä–∏—á–∏–Ω–∞:** –ó–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –∫—Ä–µ–¥–∏—Ç—ã –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ Perplexity –∏–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ https://www.perplexity.ai/settings/api
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –∑–∞–ø—Ä–æ—Å–æ–º
3. –£–º–µ–Ω—å—à–∏—Ç–µ —á–∞—Å—Ç–æ—Ç—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã `/analyze`

---

### –û—à–∏–±–∫–∞: `APIError: Model 'sonar' not found`

**–ü—Ä–∏—á–∏–Ω–∞:** –ò–∑–º–µ–Ω–∏–ª–æ—Å—å –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ Perplexity.

**–†–µ—à–µ–Ω–∏–µ:**

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ https://docs.perplexity.ai/

–û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥ –≤ `main.py`:
```python
response = perplexity_client.chat.completions.create(
    model='sonar-small-online',  # –ò–ª–∏ –¥—Ä—É–≥–æ–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –∏–º—è
    ...
)
```

–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –º–æ–¥–µ–ª–∏:
- `sonar-small-online` (–±—ã—Å—Ç—Ä–∞—è –∏ –¥–µ—à–µ–≤–∞—è)
- `sonar-medium-online` (–±–∞–ª–∞–Ω—Å)
- `sonar-large-online` (–Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è)

---

## üîå –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º

### –û—à–∏–±–∫–∞: `ConnectionError` –∏–ª–∏ timeout

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ª–∏ firewall –¥–æ—Å—Ç—É–ø –∫ Telegram/Perplexity
3. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ VPN, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä
4. –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–∫—Å–∏ –≤ –∫–æ–¥ (–µ—Å–ª–∏ –≤ –≤–∞—à–µ–π —Å—Ç—Ä–∞–Ω–µ Telegram –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω):

```python
import socks

telegram_client = TelegramClient(
    'session_name',
    API_ID,
    API_HASH,
    proxy=(socks.SOCKS5, 'proxy_address', proxy_port)
)
```

---

### –ë–æ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏–ª–∏ —Ä–∞–±–æ—Ç–∞ –Ω–∞ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ.

**–†–µ—à–µ–Ω–∏–µ:**

1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ systemd –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (—Å–º. README)
2. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –∫–æ–¥
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

---

## üíæ –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –û—à–∏–±–∫–∞: `PermissionError: [Errno 13] Permission denied`

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –î–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å
chmod +w .

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –ø—Ä–∞–≤–∞–º–∏
cd ~/chat-filter
python main.py
```

---

### –§–∞–π–ª—ã –∞–Ω–∞–ª–∏–∑–∞ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –û—à–∏–±–∫–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `save_analysis`.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ–¥–µ –Ω–µ—Ç –æ—à–∏–±–æ–∫:
```bash
python -m py_compile main.py
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è `save_analysis` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è

---

## üêß –ü—Ä–æ–±–ª–µ–º—ã –Ω–∞ Ubuntu —Å–µ—Ä–≤–µ—Ä–µ

### –°–∫—Ä–∏–ø—Ç `start_bot_background.sh` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** –°–∫—Ä–∏–ø—Ç –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
chmod +x start_bot_background.sh
./start_bot_background.sh
```

---

### Screen –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–∞–∫–µ—Ç `screen` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å–∏—Å—Ç–µ–º–µ.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
sudo apt-get update
sudo apt-get install screen
```

---

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ systemd

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω service —Ñ–∞–π–ª.

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
sudo journalctl -u telegram-bot -n 50
```

2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç–∏ –≤ service —Ñ–∞–π–ª–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ:
```ini
ExecStart=/usr/bin/python3 /home/user/chat-filter/main.py
WorkingDirectory=/home/user/chat-filter
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```bash
sudo systemctl status telegram-bot
```

---

## ü™ü –ü—Ä–æ–±–ª–µ–º—ã –Ω–∞ Windows

### –û—à–∏–±–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ (UnicodeDecodeError)

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –∫–æ–Ω—Å–æ–ª–∏ Windows.

**–†–µ—à–µ–Ω–∏–µ:**

–í –Ω–∞—á–∞–ª–µ `main.py` –¥–æ–±–∞–≤—å—Ç–µ:
```python
import sys
import io

sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')
sys.stderr = io.TextIOWrapper(sys.stderr.buffer, encoding='utf-8')
```

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ PowerShell —Å UTF-8:
```powershell
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
python main.py
```

---

### –°–∫—Ä–∏–ø—Ç—ã `.sh` –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** Windows –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç bash —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞–ø—Ä—è–º—É—é.

**–†–µ—à–µ–Ω–∏–µ:**

1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ WSL (Windows Subsystem for Linux):
```bash
wsl
cd /mnt/c/Users/YourUser/git/chat-filter
./start_bot.sh
```

2. –ò–ª–∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –±–æ—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é:
```powershell
python main.py
```

3. –°–æ–∑–¥–∞–π—Ç–µ `.bat` —Ñ–∞–π–ª –¥–ª—è Windows:
```bat
@echo off
python main.py
pause
```

---

## üìä –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–∞—á–µ—Å—Ç–≤–æ–º –∞–Ω–∞–ª–∏–∑–∞

### –í—ã–∂–∏–º–∫–∞ —Å–ª–∏—à–∫–æ–º –æ–±—â–∞—è –∏–ª–∏ –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–∞—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–º—Ç –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø–æ–¥ –≤–∞—à–∏ –∑–∞–¥–∞—á–∏.

**–†–µ—à–µ–Ω–∏–µ:**

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ `ANALYSIS_PROMPT` –≤ `main.py`:

```python
ANALYSIS_PROMPT = """–¢—ã - –∞–Ω–∞–ª–∏—Ç–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram —á–∞—Ç–∞—Ö. 

–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤–∫–ª—é—á–∏ –≤ –≤—ã–∂–∏–º–∫—É:
1. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ü–∏—Ñ—Ä—ã, –¥–∞—Ç—ã –∏ —Ñ–∞–∫—Ç—ã
2. –ò–º–µ–Ω–∞ –ª—é–¥–µ–π –∏ –∏—Ö —Ä–æ–ª–∏
3. –ü—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
4. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
5. –î–µ–¥–ª–∞–π–Ω—ã –∏ —Å—Ä–æ–∫–∏

–ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º. –ò–∑–±–µ–≥–∞–π –æ–±—â–∏—Ö —Ñ—Ä–∞–∑.
"""
```

---

### Perplexity –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç —Å–∏–º–≤–æ–ª–æ–≤ (15000).

**–†–µ—à–µ–Ω–∏–µ:**

1. –£–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç –≤ –∫–æ–¥–µ:
```python
max_chars = 30000  # –í —Ñ—É–Ω–∫—Ü–∏–∏ create_summary
```

2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–π –ø–µ—Ä–∏–æ–¥:
```
/analyze 12h  # –í–º–µ—Å—Ç–æ /analyze 2d
```

3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª—å —Å –±–æ–ª—å—à–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### –í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ `main.py`:

```python
import logging

logging.basicConfig(
    level=logging.DEBUG,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('bot.log'),
        logging.StreamHandler()
    ]
)
```

–¢–µ–ø–µ—Ä—å –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –±–æ—Ç–∞ –±—É–¥—É—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤ `bot.log`.

---

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Telegram

```python
async def test_connection():
    async with TelegramClient('test_session', API_ID, API_HASH) as client:
        me = await client.get_me()
        print(f"–£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫–∞–∫: {me.username}")

asyncio.run(test_connection())
```

---

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Perplexity API

```python
from openai import OpenAI

client = OpenAI(
    api_key=PERPLEXITY_API_KEY,
    base_url='https://api.perplexity.ai'
)

try:
    response = client.chat.completions.create(
        model='sonar',
        messages=[
            {'role': 'user', 'content': '–¢–µ—Å—Ç'}
        ]
    )
    print("Perplexity API —Ä–∞–±–æ—Ç–∞–µ—Ç!")
    print(response.choices[0].message.content)
except Exception as e:
    print(f"–û—à–∏–±–∫–∞: {e}")
```

---

## üìû –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   ```bash
   # Linux
   tail -f bot.log
   
   # Windows
   type bot.log
   ```

2. **–°–æ–±–µ—Ä–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∏—Å—Ç–µ–º–µ:**
   ```bash
   python --version
   pip list | grep telethon
   pip list | grep openai
   uname -a  # Linux
   systeminfo  # Windows
   ```

3. **–°–æ–∑–¥–∞–π—Ç–µ issue –Ω–∞ GitHub:**
   - –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É
   - –ü—Ä–∏–ª–æ–∂–∏—Ç–µ –ª–æ–≥–∏ (–±–µ–∑ API –∫–ª—é—á–µ–π!)
   - –£–∫–∞–∂–∏—Ç–µ –≤–µ—Ä—Å–∏—é Python –∏ –û–°

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:**
   - [Telethon](https://docs.telethon.dev/)
   - [Perplexity API](https://docs.perplexity.ai/)
   - [OpenAI Python Library](https://github.com/openai/openai-python)

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### ‚ùå –ù–ï –¥–æ–±–∞–≤–ª—è–π—Ç–µ `private.txt` –≤ git
```bash
# –ï—Å–ª–∏ —Å–ª—É—á–∞–π–Ω–æ –¥–æ–±–∞–≤–∏–ª–∏:
git rm --cached private.txt
git commit -m "Remove private.txt"
```

### ‚ùå –ù–ï –¥–µ–ª–∏—Ç–µ—Å—å —Ñ–∞–π–ª–æ–º —Å–µ—Å—Å–∏–∏ (*.session)
–≠—Ç–æ —Ä–∞–≤–Ω–æ—Å–∏–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—á–µ –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–∞—à–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É!

### ‚ùå –ù–ï –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –±–æ—Ç–∞ –æ—Ç root –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
```bash
# –ü–ª–æ—Ö–æ:
sudo python main.py

# –•–æ—Ä–æ—à–æ:
python main.py
```

---

–ï—Å–ª–∏ –≤–∞—à–∞ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –æ–ø–∏—Å–∞–Ω–∞ –∑–¥–µ—Å—å, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ [–æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](README.md) –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

